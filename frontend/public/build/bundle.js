var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function r(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function c(t,n){t.appendChild(n)}function l(t,n,e){t.insertBefore(n,e||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function a(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function d(t){return document.createElement(t)}function s(t){return document.createTextNode(t)}function f(){return s(" ")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function h(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function g(t){return""===t?null:+t}function m(t,n){n=""+n,t.wholeText!==n&&(t.data=n)}function $(t,n){t.value=null==n?"":n}let y;function b(t){y=t}const v=[],x=[];let C=[];const _=[],k=Promise.resolve();let E=!1;function T(t){C.push(t)}const j=new Set;let N=0;function O(){if(0!==N)return;const t=y;do{try{for(;N<v.length;){const t=v[N];N++,b(t),w(t.$$)}}catch(t){throw v.length=0,N=0,t}for(b(null),v.length=0,N=0;x.length;)x.pop()();for(let t=0;t<C.length;t+=1){const n=C[t];j.has(n)||(j.add(n),n())}C.length=0}while(v.length);for(;_.length;)_.pop()();E=!1,j.clear(),b(t)}function w(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(T)}}const z=new Set;function S(t,n){const e=t.$$;null!==e.fragment&&(!function(t){const n=[],e=[];C.forEach((o=>-1===t.indexOf(o)?n.push(o):e.push(o))),e.forEach((t=>t())),C=n}(e.after_update),o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function P(t,n){-1===t.$$.dirty[0]&&(v.push(t),E||(E=!0,k.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function q(r,c,l,a,d,s,f,p=[-1]){const h=y;b(r);const g=r.$$={fragment:null,ctx:[],props:s,update:t,not_equal:d,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(h?h.$$.context:[])),callbacks:e(),dirty:p,skip_bound:!1,root:c.target||h.$$.root};f&&f(g.root);let m=!1;if(g.ctx=l?l(r,c.props||{},((t,n,...e)=>{const o=e.length?e[0]:n;return g.ctx&&d(g.ctx[t],g.ctx[t]=o)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](o),m&&P(r,t)),n})):[],g.update(),m=!0,o(g.before_update),g.fragment=!!a&&a(g.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);g.fragment&&g.fragment.l(t),t.forEach(u)}else g.fragment&&g.fragment.c();c.intro&&(($=r.$$.fragment)&&$.i&&(z.delete($),$.i(v))),function(t,e,r,c){const{fragment:l,after_update:u}=t.$$;l&&l.m(e,r),c||T((()=>{const e=t.$$.on_mount.map(n).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(T)}(r,c.target,c.anchor,c.customElement),O()}var $,v;b(h)}class A{$destroy(){S(this,1),this.$destroy=t}$on(n,e){if(!i(e))return t;const o=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function L(t,n,e){const o=t.slice();return o[22]=n[e],o}function B(t,n,e){const o=t.slice();return o[22]=n[e],o}function D(t){let n,e,i,r,a,m,y,b,v,x,C,_,k,E,T,j,N,O;return{c(){n=d("h2"),n.textContent="Dettaglio prodotto",e=f(),i=d("div"),r=d("label"),a=s("Titolo:\n\t\t"),m=d("input"),y=f(),b=d("label"),v=s("Descrizione:\n\t\t"),x=d("textarea"),C=f(),_=d("label"),k=s("Prezzo:\n\t\t"),E=d("input"),T=f(),j=d("button"),j.textContent="Salva",h(E,"type","number"),h(E,"step","0.01"),h(i,"class","product svelte-16ohvta")},m(o,u){l(o,n,u),l(o,e,u),l(o,i,u),c(i,r),c(r,a),c(r,m),$(m,t[2].title),c(i,y),c(i,b),c(b,v),c(b,x),$(x,t[2].description),c(i,C),c(i,_),c(_,k),c(_,E),$(E,t[2].price),c(i,T),c(i,j),N||(O=[p(m,"input",t[13]),p(x,"input",t[14]),p(E,"input",t[15]),p(j,"click",t[8])],N=!0)},p(t,n){4&n&&m.value!==t[2].title&&$(m,t[2].title),4&n&&$(x,t[2].description),4&n&&g(E.value)!==t[2].price&&$(E,t[2].price)},d(t){t&&u(n),t&&u(e),t&&u(i),N=!1,o(O)}}}function J(t){let n,e,o;function i(){return t[17](t[22])}return{c(){n=d("button"),n.textContent="Aggiungi al carrello"},m(t,r){l(t,n,r),e||(o=p(n,"click",i),e=!0)},p(n,e){t=n},d(t){t&&u(n),e=!1,o()}}}function I(t){let n,e,i,r,a,g,$,y,b,v,x,C,_,k,E,T,j,N,O,w,z,S=t[22].id+"",P=t[22].title+"",q=t[22].description.slice(0,10)+"",A=t[22].description.length>10?"...":"",L=t[22].price+"";function B(){return t[16](t[22])}let D=t[4]&&J(t);function I(){return t[18](t[22])}return{c(){n=d("div"),e=d("h2"),i=s(S),r=s(": "),a=s(P),g=f(),$=d("p"),y=s(q),b=s(A),v=f(),x=d("p"),C=s("Prezzo: "),_=s(L),k=s("€"),E=f(),D&&D.c(),T=f(),j=d("button"),j.textContent="Cancella",N=f(),h(n,"class",O="product "+(t[1]&&t[1].id===t[22].id?"selected":"")+" svelte-16ohvta")},m(t,o){l(t,n,o),c(n,e),c(e,i),c(e,r),c(e,a),c(n,g),c(n,$),c($,y),c($,b),c(n,v),c(n,x),c(x,C),c(x,_),c(x,k),c(n,E),D&&D.m(n,null),c(n,T),c(n,j),c(n,N),w||(z=[p(e,"click",B),p(j,"click",I)],w=!0)},p(e,o){t=e,1&o&&S!==(S=t[22].id+"")&&m(i,S),1&o&&P!==(P=t[22].title+"")&&m(a,P),1&o&&q!==(q=t[22].description.slice(0,10)+"")&&m(y,q),1&o&&A!==(A=t[22].description.length>10?"...":"")&&m(b,A),1&o&&L!==(L=t[22].price+"")&&m(_,L),t[4]?D?D.p(t,o):(D=J(t),D.c(),D.m(n,T)):D&&(D.d(1),D=null),3&o&&O!==(O="product "+(t[1]&&t[1].id===t[22].id?"selected":"")+" svelte-16ohvta")&&h(n,"class",O)},d(t){t&&u(n),D&&D.d(),w=!1,o(z)}}}function G(n){let e,o,i;return{c(){e=d("button"),e.textContent="Login"},m(t,r){l(t,e,r),o||(i=p(e,"click",n[9]),o=!0)},p:t,d(t){t&&u(e),o=!1,i()}}}function H(t){let n,e,o,i,r,c,s,g=t[3],m=[];for(let n=0;n<g.length;n+=1)m[n]=M(L(t,g,n));return{c(){n=d("h2"),n.textContent="Carrello",e=f(),o=d("button"),o.textContent="Logout",i=f(),r=d("div");for(let t=0;t<m.length;t+=1)m[t].c();h(r,"class","cart")},m(u,a){l(u,n,a),l(u,e,a),l(u,o,a),l(u,i,a),l(u,r,a);for(let t=0;t<m.length;t+=1)m[t]&&m[t].m(r,null);c||(s=p(o,"click",t[10]),c=!0)},p(t,n){if(4104&n){let e;for(g=t[3],e=0;e<g.length;e+=1){const o=L(t,g,e);m[e]?m[e].p(o,n):(m[e]=M(o),m[e].c(),m[e].m(r,null))}for(;e<m.length;e+=1)m[e].d(1);m.length=g.length}},d(t){t&&u(n),t&&u(e),t&&u(o),t&&u(i),t&&u(r),a(m,t),c=!1,s()}}}function M(t){let n,e,o,i,r,a,g,$,y,b,v,x,C,_,k,E,T,j=t[22].title+"",N=t[22].quantity+"",O=t[22].price+"";function w(){return t[19](t[22])}return{c(){n=d("div"),e=d("h3"),o=s(j),i=f(),r=d("p"),a=s("Quantità: "),g=s(N),$=f(),y=d("p"),b=s("Prezzo: "),v=s(O),x=s("€"),C=f(),_=d("button"),_.textContent="Cancella",k=f(),h(n,"class","cart-item")},m(t,u){l(t,n,u),c(n,e),c(e,o),c(n,i),c(n,r),c(r,a),c(r,g),c(n,$),c(n,y),c(y,b),c(y,v),c(y,x),c(n,C),c(n,_),c(n,k),E||(T=p(_,"click",w),E=!0)},p(n,e){t=n,8&e&&j!==(j=t[22].title+"")&&m(o,j),8&e&&N!==(N=t[22].quantity+"")&&m(g,N),8&e&&O!==(O=t[22].price+"")&&m(v,O)},d(t){t&&u(n),E=!1,T()}}}function Q(n){let e,o,i,r,c,g,m,$,y=n[1]&&D(n),b=n[0],v=[];for(let t=0;t<b.length;t+=1)v[t]=I(B(n,b,t));function x(t,n){return t[4]?H:G}let C=x(n),_=C(n);return{c(){e=d("button"),e.textContent="Nuovo prodotto",o=f(),y&&y.c(),i=f(),r=d("div");for(let t=0;t<v.length;t+=1)v[t].c();c=f(),_.c(),g=s(""),h(r,"class","grid svelte-16ohvta")},m(t,u){l(t,e,u),l(t,o,u),y&&y.m(t,u),l(t,i,u),l(t,r,u);for(let t=0;t<v.length;t+=1)v[t]&&v[t].m(r,null);l(t,c,u),_.m(t,u),l(t,g,u),m||($=p(e,"click",n[5]),m=!0)},p(t,[n]){if(t[1]?y?y.p(t,n):(y=D(t),y.c(),y.m(i.parentNode,i)):y&&(y.d(1),y=null),2259&n){let e;for(b=t[0],e=0;e<b.length;e+=1){const o=B(t,b,e);v[e]?v[e].p(o,n):(v[e]=I(o),v[e].c(),v[e].m(r,null))}for(;e<v.length;e+=1)v[e].d(1);v.length=b.length}C===(C=x(t))&&_?_.p(t,n):(_.d(1),_=C(t),_&&(_.c(),_.m(g.parentNode,g)))},i:t,o:t,d(t){t&&u(e),t&&u(o),y&&y.d(t),t&&u(i),t&&u(r),a(v,t),t&&u(c),_.d(t),t&&u(g),m=!1,$()}}}const F="http://localhost:3000";async function K(t,n={}){const e=await fetch(t,n);return await e.json()}function R(t,n,e){let o=[];async function i(){K(`${F}/product`).then((t=>e(0,o=t)))}i();let r=null,c=null,l=[];function u(t){K(`${F}/product/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((t=>i()))}function a(t){e(1,r=o.find((n=>n.id===t))),e(2,c={...r})}let d=null;function s(){K(`${F}/cart`,{method:"GET",headers:{"Content-Type":"application/json",authorization:`Bearer: ${d}`}}).then((t=>{e(3,l=[]);for(const n of t)K(`${F}/product/${n.product_id}`).then((t=>{l.push({id:t.id,title:t.title,quantity:n.quantity,price:n.quantity*t.price}),e(3,l)}))}))}function f(t){K(`${F}/cart`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer: ${d}`},body:JSON.stringify({productId:t.id})}).then((t=>{s()}))}function p(t){K(`${F}/cart`,{method:"DELETE",headers:{"Content-Type":"application/json",authorization:`Bearer: ${d}`},body:JSON.stringify({productId:t})}).then((t=>{s()}))}return[o,r,c,l,d,function(){e(1,r=e(2,c=null)),K(`${F}/product`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"",description:"",price:0})}).then((t=>i()))},u,a,function(){const t=o.findIndex((t=>t.id===c.id));let n={};for(const e in c)o[t][e]!==c[e]&&(n[e]=c[e]);K(`http://localhost:3000/product/${c.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((t=>i())),e(1,r=e(2,c=null))},function(){K(`${F}/login`,{method:"POST",headers:{"Content-Type":"application/json"}}).then((t=>{e(4,d=t.token),s()}))},function(){e(4,d=null)},f,p,function(){c.title=this.value,e(2,c)},function(){c.description=this.value,e(2,c)},function(){c.price=g(this.value),e(2,c)},t=>a(t.id),t=>f(t),t=>u(t.id),t=>p(t.id)]}return new class extends A{constructor(t){super(),q(this,t,R,Q,r,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
